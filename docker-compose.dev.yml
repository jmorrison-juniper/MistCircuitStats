version: '3.8'

services:
  mistcircuitstats-dev:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        BUILD_DATE: ${BUILD_DATE:-$(date -u +'%Y-%m-%dT%H:%M:%SZ')}
        VERSION: dev
    container_name: mistcircuitstats-dev
    restart: unless-stopped
    ports:
      - "5000:5000"
    environment:
      - MIST_APITOKEN=${MIST_APITOKEN}
      - MIST_ORG_ID=${MIST_ORG_ID:-}
      - MIST_HOST=${MIST_HOST:-api.mist.com}
      - PORT=5000
      - LOG_LEVEL=DEBUG
    env_file:
      - .env
    volumes:
      - ./:/app
      - /app/__pycache__
    command: ["flask", "run", "--host=0.0.0.0", "--port=5000", "--debug"]
